function doPost(e) {
  try {
    // Get form data from the request
    const formData = e.parameter;
    
    // Get the active spreadsheet
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    
    // Create timestamp
    const timestamp = new Date().toLocaleString();
    
    // Prepare row data
    const rowData = [
      timestamp,
      formData.name || '',
      formData.email || '',
      formData.phone || '',
      formData.attendance || '',
      formData.guests || '',
      formData.dietaryRestrictions || '',
      formData.message || ''
    ];
    
    // Append the data to the sheet
    sheet.appendRow(rowData);
    
    // Return success response
    return ContentService
      .createTextOutput('Success')
      .setMimeType(ContentService.MimeType.TEXT);
      
  } catch (error) {
    // Return error response
    return ContentService
      .createTextOutput('Error: ' + error.toString())
      .setMimeType(ContentService.MimeType.TEXT);
  }
}

function doGet(e) {
  return ContentService
    .createTextOutput('RSVP API is running')
    .setMimeType(ContentService.MimeType.TEXT);
} 